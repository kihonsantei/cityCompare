{"version":3,"file":"js/main.7a6e8787.js","mappings":"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","sources":["webpack://citycompare/./src/GeneralFrame.vue","webpack://citycompare/./src/frames/headPane.vue","webpack://citycompare/./src/frames/headPane.vue?3df2","webpack://citycompare/./src/frames/footPane.vue","webpack://citycompare/./src/frames/footPane.vue?ac9c","webpack://citycompare/./src/stores/BallScalingStore.js","webpack://citycompare/./src/stores/ballstateStore.js","webpack://citycompare/./src/tools/coord_polar.js","webpack://citycompare/./src/stores/MapComponentStore.js","webpack://citycompare/./src/stores/MapListStroe.js","webpack://citycompare/./src/stores/PickCenterStore.js","webpack://citycompare/./src/stores/BallMovingScalingStore.js","webpack://citycompare/./src/stores/CreateMapCoordDetemineFeatureStore.js","webpack://citycompare/./src/core/SettingPane.vue","webpack://citycompare/./src/core/SettingPane.vue?0ad5","webpack://citycompare/./src/core/EarthPane.vue","webpack://citycompare/./src/core/EarthPane.vue?0dc0","webpack://citycompare/./src/GeneralFrame.vue?8fe6","webpack://citycompare/./src/main.js","webpack://citycompare/webpack/bootstrap","webpack://citycompare/webpack/runtime/chunk loaded","webpack://citycompare/webpack/runtime/compat get default export","webpack://citycompare/webpack/runtime/define property getters","webpack://citycompare/webpack/runtime/global","webpack://citycompare/webpack/runtime/hasOwnProperty shorthand","webpack://citycompare/webpack/runtime/jsonp chunk loading","webpack://citycompare/webpack/startup"],"sourcesContent":["<template>\n  <div class=\"app-container\">\n    <headPane class=\"header\" />\n    <div class=\"noheader\">\n    <div class=\"main-content\">\n      <div class=\"left-center\">\n        <EarthPane :id=\"'left'\"/>\n        <EarthPane :id=\"'right'\"/>\n      </div>\n      <footPane class=\"footer\" />\n    </div>\n    <SettingPane class=\"sidebar\" />\n    </div>\n  </div>\n</template>\n\n<script>\n//import EarthPane from './components/EarthPane.vue'\nimport headPane from './frames/headPane.vue'\nimport footPane from './frames/footPane.vue'\nimport SettingPane from './core/SettingPane.vue';\nimport EarthPane from './core/EarthPane.vue';\n\nexport default {\n  name: 'GeneralFrame',\n  components: {\n    headPane,\n    footPane,\n    SettingPane,\n    EarthPane\n  }\n}\n\n\n</script>\n<style>\nhtml,body {\n  height: 100%;\n  margin: 0;\n  padding: 0;\n  overflow: hidden;\n}\n.app-container {\n  display: flex;\n  flex-direction:column;\n  height: 100vh; \n  margin: 0;\n  padding: 0;\n  /* 防止横向滚动 */\n  box-sizing: border-box;\n  /*控制元素的盒模型计算方式*/\n  /*在border-box模式下,元素的 width 和 height 包含 内容、内边距、边框*/\n}\n\n/* 顶部固定导航 */\n.header {\n  \n  height: 60px;\n  width: 100vw;\n  top: 0; left: 0; right: 0;\n}\n\n.noheader{\n  display: flex;\n  flex-direction: row;\n  flex:1;\n  \n}\n\n/* 主内容区，下方填充顶部导航高度 */\n.main-content {\n  flex: 1;\n  display: flex;\n  flex-direction:column;\n  padding-top:0px; /* 避开固定头部 */\n  box-sizing: border-box;\n}\n\n/* 左侧和中间区域容器，两个 EarthPane 并排 */\n.left-center {\n  flex: 1;\n  display: flex;\n  gap:10px;\n}\n\n/* 每个 EarthPane 占一半宽，黄色背景 */\n.left-center > * {\n  flex: 1;\n  background-color: #ffeb3b; /* 黄色 */\n  padding: 10px;\n  box-sizing: border-box;\n}\n/* 底部页脚 */\n.footer {\n  display: flex;\n  box-sizing: border-box;\n  height: 50px;\n  color: white;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n/* 右侧绿色侧栏固定宽度 */\n.sidebar {\n  width:350px;\n  box-sizing: border-box;\n  border: 2px solid black;\n}\n\n\n\n</style>\n","<template>\r\n    <header class=\"top-menu\">\r\n        <span class=\"top-menu-word\">城对CityPair</span>\r\n    </header>\r\n</template>\r\n<script>\r\nexport default{\r\n    name:'headPane',\r\n}\r\n</script>\r\n<style scoped>\r\n.top-menu{\r\n  \r\nfont-weight: bold;\r\n  background-color: #999; /* 灰色背景，和你之前喜欢的一致 */\r\n  color: white;\r\n  line-height: 60px;\r\n  text-align: left;\r\n  user-select: none; /* 防止选中文字 */\r\n}\r\n.top-menu-word {\r\n  font-family: \"SimSun\", serif; /* 宋体 */\r\n  font-size: 24px;\r\n  padding: 0 20px;\r\n\r\n\r\n}\r\n</style>","import { render } from \"./headPane.vue?vue&type=template&id=4eda1d2e&scoped=true\"\nimport script from \"./headPane.vue?vue&type=script&lang=js\"\nexport * from \"./headPane.vue?vue&type=script&lang=js\"\n\nimport \"./headPane.vue?vue&type=style&index=0&id=4eda1d2e&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-4eda1d2e\"]])\n\nexport default __exports__","<template>\r\n    <footer class=\"footer-menu\">\r\n        <span class=\"footer-menu-word\">版权所有 杨宗翰 yangzonghan24 @mails.ucas.ac.cn BiliBili <a href=\"https://space.bilibili.com/174911884\">@奇策三定</a> 公众号 <a href=\"https://mp.weixin.qq.com/s/Fis-czNIu42RzktKnY_INw\">@奇行策</a></span>\r\n    </footer>\r\n</template>\r\n<script>\r\nexport default{\r\n    name:'footPane',\r\n}\r\n</script>\r\n<style scoped>\r\n.footer-menu{\r\n  background-color: #999; /* 灰色 */\r\n  color: white;\r\n  text-align: left;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  white-space: nowrap;\r\n\r\n}\r\n.footer-menu-word {\r\n  font-weight: bold;\r\n  font-size:12px;\r\n  color: white;\r\n  padding: 8px 20px;\r\n\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  white-space: nowrap;\r\n}\r\n</style>","import { render } from \"./footPane.vue?vue&type=template&id=705ebb95&scoped=true\"\nimport script from \"./footPane.vue?vue&type=script&lang=js\"\nexport * from \"./footPane.vue?vue&type=script&lang=js\"\n\nimport \"./footPane.vue?vue&type=style&index=0&id=705ebb95&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-705ebb95\"]])\n\nexport default __exports__","import { defineStore } from \"pinia\";\r\nimport { reactive} from 'vue';\r\n\r\n\r\nexport const useMapZoomStore = defineStore('mapZoom', () => {\r\n  // zoomState: { [id]: { center: [lng, lat], zoom: number } }\r\n  const zoomState = reactive({\r\n    1:{\r\n        zoomcenter:[116.405415,39.907741],\r\n        scale:12\r\n    },\r\n    2:{\r\n        zoomcenter:[121.47489,31.232838],\r\n        scale:12\r\n    }\r\n  })\r\n\r\n  // 更新指定id的缩放信息\r\n  //这个函数基本只用来创建新zoom\r\n  function updateZoom(id, zoomcenter, scale) {\r\n    console.log(\"把\",id,\"的zoomcenter更新成\",zoomcenter,\"scale更新成\",scale)\r\n    if (!zoomState[id]) {\r\n      zoomState[id] = { zoomcenter, scale }\r\n    } else {\r\n      zoomState[id].zoomcenter = zoomcenter\r\n      zoomState[id].scale = scale\r\n    }\r\n  }\r\n\r\n  // 删除指定id的缩放信息\r\n  function deleteZoom(id) {\r\n    if (zoomState[id]) {\r\n      delete zoomState[id]\r\n    }\r\n  }\r\n\r\n  function getZoomState(id){\r\n     if (zoomState[id]) {\r\n        return zoomState[id]\r\n     }\r\n     else{\r\n        return null;\r\n     }\r\n  }\r\n\r\n  return {\r\n    zoomState,\r\n    updateZoom,\r\n    deleteZoom,\r\n    getZoomState\r\n  }\r\n})","import { defineStore } from \"pinia\"\r\nimport {ref} from 'vue'\r\n\r\n\r\nexport const ballstateStore = defineStore('ball', () => {\r\n  const currentleftid = ref(0)  // 初始绑定到0\r\n  const currentrightid = ref(0) // 初始绑定到0\r\n  //左球的状态\r\n    // currentLeftName和rightname都能切换到对应的name\r\n    //console.log(left.value)\r\n  function getcurrentid(id){\r\n    if (id==\"left\"){\r\n      return currentleftid.value;\r\n    }\r\n    else if (id==\"right\"){\r\n      return currentrightid.value;\r\n    }\r\n    else{\r\n      return null;\r\n    }\r\n\r\n  }\r\n  return {\r\n    currentleftid,\r\n    currentrightid,\r\n    getcurrentid\r\n  }\r\n})","import { getDistance, getGreatCircleBearing } from 'geolib'\r\n/**\r\n * 计算每个点相对中心点的距离和方位角\r\n * @param {Object} centerPoint - 中心点 { latitude: number, longitude: number }\r\n * @param {Array} coordinates - 点数组 [{ latitude: number, longitude: number }]\r\n * @returns {Array} - 每个点的距离和方位角 [{ distance: number, bearing: number }]\r\n */\r\n\r\n\r\nexport function computeDistanceAndBearing(centerPoint, coord,mode=\"single\") {\r\n    if (mode==\"single\"){\r\n        const distance = getDistance(centerPoint, coord)\r\n        const bearing = getGreatCircleBearing(centerPoint, coord)\r\n        return {\r\n            \"distance\":distance,\r\n            \"bearing\":bearing\r\n        }\r\n    }\r\n\r\n}\r\n\r\nimport { computeDestinationPoint } from 'geolib'\r\n\r\n/**\r\n * 给定中心点、距离和方位角，计算终点坐标\r\n * @param {Object} centerPoint - 中心点 { latitude, longitude }\r\n * @param {number} distance - 距离（单位：米）\r\n * @param {number} bearing - 方位角（单位：度，0=北，90=东，180=南，270=西）\r\n * @returns {Object} - 终点坐标 { latitude, longitude }\r\n */\r\nexport function computeSymmetricPoint(centerPoint, distance, bearing,mode=\"single\") {\r\n   if (mode==\"single\"){\r\n     return computeDestinationPoint(centerPoint, distance, bearing);\r\n   }\r\n}","import { defineStore } from \"pinia\"\r\nimport { computed, ref, watch, shallowRef } from 'vue'\r\n\r\nexport const ComponentListStore = defineStore('mapComponent', () => {\r\n    const style = ref({\r\n        1: {\r\n            \"color\": \"#66CCFF\",\r\n            \"show\": true,\r\n            \"geometry\": [\r\n                {\r\n                    \"name\": \"测试点1\",\r\n                    \"type\": \"point\",\r\n                    \"dist\": 500,\r\n                    \"direction\": 30\r\n                },\r\n            ]\r\n        },\r\n        2: {\r\n            \"color\": \"#DDBBFF\",\r\n            \"show\": true,\r\n            \"geometry\": [\r\n                {\r\n                    \"name\": \"测试点2\",\r\n                    \"type\": \"point\",\r\n                    \"dist\": 1000,\r\n                    \"direction\": 45\r\n                }\r\n            ]\r\n        }\r\n    })\r\n\r\n    function createNewStyle(id, color = '#CCCCCC') {\r\n        if (!style.value[id]) {\r\n            style.value[id] = {\r\n                color,\r\n                show: true,\r\n                geometry: [],\r\n            }\r\n        } else {\r\n            console.warn(`ID ${id} 已存在，未覆盖。`)\r\n        }\r\n    }\r\n    function deleteStyle(id) {\r\n        if (style.value[id]) {\r\n            delete style.value[id]\r\n        } else {\r\n            console.warn(`ID ${id} 不存在，无法删除。`)\r\n        }\r\n    }\r\n    function getStyle(id) {\r\n        const result = style.value[id]\r\n        if (result) {\r\n            return result\r\n        } else {\r\n            //如果没有就返回个空的\r\n            console.warn(`ID ${id} 不存在。`)\r\n            return {}\r\n        }\r\n    }\r\n    function addGeometryToStyle(id, geometryItem) {\r\n        if (style.value[id]) {\r\n            style.value[id].geometry.push(geometryItem)\r\n        } else {\r\n            console.warn(`ID ${id} 不存在，无法添加 geometry。`)\r\n        }\r\n        console.log(\"添加过，当前的style如下\", style)\r\n    }\r\n    function getAllStyleKeys() {\r\n        return Object.keys(style.value)\r\n    }\r\n    return {\r\n        style,\r\n        createNewStyle,\r\n        deleteStyle,\r\n        getStyle,\r\n        addGeometryToStyle,\r\n        getAllStyleKeys\r\n    }\r\n\r\n}\r\n)\r\n\r\n// 主要负责计算出对应的LeafletMap图层\r\n// 绘制逻辑：获取ref对应的id\r\n// 首先绘制所有中心点\r\n// 如果是空球，就根据标准的绘制(需要获取所有的中心点，没有中心点也就意味着不会有component，可以直接跳过)\r\n// 生成球的图层\r\n// 如果不是空球，从主要的读取中心点，开始遍历绘制\r\n// 生成球的图层\r\n\r\n//监听 如果任何一个refid变了都要全部重绘\r\n//监听 如果style变了只需要获取对应id的重绘\r\n//更新 重绘后记录到事件，在球图层中监听这个事件，如果发生变化就更新球\r\n\r\n//不管了，监听球切换和style更换，只要有变换我就重绘\r\nimport { ballstateStore } from \"./ballstateStore\"\r\nimport { MapListStore } from \"./MapListStroe\"\r\nimport L from 'leaflet'\r\nimport 'leaflet/dist/leaflet.css'\r\nimport { computeSymmetricPoint } from \"@/tools/coord_polar\"\r\n\r\n\r\ndelete L.Icon.Default.prototype._getIconUrl\r\nL.Icon.Default.mergeOptions({\r\n    iconUrl: '/images/marker-icon.png',\r\n    iconRetinaUrl: '/images/marker-icon-2x.png',\r\n    shadowUrl: '/images/marker-shadow.png',\r\n})\r\n\r\nfunction createLabeledMarker(lat, lng, color, label) {\r\n    const icon = L.divIcon({\r\n        className: 'labeled-marker-icon',\r\n        html: `\r\n      <div style=\"position: relative; display: flex; align-items: center;\">\r\n        <div style=\"\r\n          width: 12px;\r\n          height: 12px;\r\n          background-color: ${color};\r\n          border-radius: 50%;\r\n          border: 2px solid white;\r\n          box-shadow: 0 0 2px rgba(0,0,0,0.5);\r\n          margin-right: 4px;\r\n        \"></div>\r\n        <div style=\"\r\n          background: white;\r\n          padding: 4px 8px;\r\n          border-radius: 4px;\r\n          font-size: 13px;\r\n          color: black;\r\n          border: 1px solid #ccc;\r\n          box-shadow: 0 0 5px rgba(0,0,0,0.1);\r\n          white-space: nowrap;\r\n        \">\r\n          ${label}\r\n        </div>\r\n      </div>\r\n    `,\r\n        iconSize: null,\r\n        iconAnchor: [0, 12], // 圆点底部对准坐标\r\n    });\r\n\r\n    return L.marker([lat, lng], { icon });\r\n}\r\n\r\n\r\nexport const DrawBallMap = defineStore(\"DrawBallMap\", () => {\r\n\r\n    const ballstate = ballstateStore()\r\n    const mapliststore = MapListStore()\r\n    const componentliststore = ComponentListStore()\r\n    //leftid对应的中心\r\n    const leftBallCenter = computed(() => {\r\n        const id = ballstate.getcurrentid(\"left\")\r\n        if (!id || !mapliststore.views[id]) return []\r\n        return mapliststore.views[id].center\r\n    })\r\n    const rightBallCenter = computed(() => {\r\n        const id = ballstate.getcurrentid(\"right\")\r\n        if (!id || !mapliststore.views[id]) return []\r\n\r\n        return mapliststore.views[id].center\r\n    })\r\n    const drawedlayerleft = shallowRef([])\r\n    const drawedlayerright = shallowRef([])\r\n\r\n    function getlayerref(side) {\r\n        if (side == \"left\") {\r\n            return drawedlayerleft\r\n        }\r\n        else if (side == \"right\") {\r\n            return drawedlayerright\r\n        }\r\n    }\r\n\r\n    function updatelayer(side) {\r\n        //绘制中心\r\n        var geomlist = [];\r\n        let center = null\r\n        let id = null\r\n        if (side == \"left\") {\r\n            center = leftBallCenter.value\r\n            id = ballstate.getcurrentid(\"left\")\r\n        }\r\n        else if (side == \"right\") {\r\n            center = rightBallCenter.value\r\n            id = ballstate.getcurrentid(\"right\")\r\n        }\r\n        //如果id是空的先什么都不绘制，否则绘制\r\n        if (id <= 0) {\r\n            console.log(\"woc\")\r\n                        if (side == \"left\") {\r\n              drawedlayerleft.value=[]\r\n            }\r\n            else if (side == \"right\") {\r\n              drawedlayerright.value =[]  \r\n            }\r\n        }\r\n        else {\r\n            if (center && Array.isArray(center) && center.length === 2) {\r\n                //获取颜色\r\n                const marker = createLabeledMarker(center[1], center[0], componentliststore.getStyle(id).color, mapliststore.views[id].name)\r\n                geomlist.push(marker)\r\n            \r\n            const idlist=componentliststore.getAllStyleKeys()\r\n            console.log(\"有这些key\",idlist)\r\n            const centerPoint={\r\n                latitude: center[1],   // 纬度\r\n                longitude: center[0]   // 经度\r\n                }\r\n             for (const id in idlist){\r\n                const styleObj = componentliststore.getStyle(id)\r\n                const geometry = styleObj.geometry || []\r\n                const color = styleObj.color || '#3388ff'\r\n                const markerList = []\r\n                for (const geo of geometry) {\r\n                    if (geo.type === 'point'){\r\n                        const { dist, direction, name } = geo\r\n                        const point = computeSymmetricPoint(centerPoint, dist, direction)\r\n                        const marker = createLabeledMarker(point.latitude,point.longitude,color,name)\r\n                        console.log(\"创建点\",name)\r\n                        markerList.push(marker)\r\n                    }\r\n                }\r\n                if (markerList.length > 0) {\r\n                    const layerGroup = L.layerGroup(markerList)\r\n                    geomlist.push(layerGroup)}\r\n                }\r\n            //创建一个图层，以id标识\r\n        \r\n                //获取其颜色\r\n                //获取其是否可见\r\n                //如果可见,循环geometry\r\n                    //反算其坐标，绘制，加入\r\n            \r\n            if (side == \"left\") {\r\n                drawedlayerleft.value = geomlist\r\n                //drawedlayerleft.value.splice(0, drawedlayerleft.value.length, ...geomlist)\r\n                console.log(\"更新左侧drawedlayerleft\", drawedlayerleft)\r\n            }\r\n            else if (side == \"right\") {\r\n                drawedlayerright.value = geomlist\r\n                //drawedlayerright.value.splice(0, drawedlayerright.value.length, ...geomlist)\r\n            }\r\n            }\r\n            else{\r\n            if (side == \"left\") {\r\n              drawedlayerleft.value=[]\r\n            }\r\n            else if (side == \"right\") {\r\n              drawedlayerright.value =[]  \r\n            }\r\n            }\r\n        }\r\n    }\r\n    //watch ballcenter或者style,只要变动就重新绘制\r\n    watch(\r\n        [\r\n            () => leftBallCenter.value,\r\n            () => rightBallCenter.value,\r\n            () => componentliststore.style,\r\n        ],\r\n        () => {\r\n            console.log(\"update layer\")\r\n            //console.log(\"左侧全局图层\",drawedlayerleft)\r\n            //console.log(\"右侧全局图层\",drawedlayerright)\r\n            updatelayer('left')\r\n            updatelayer('right')\r\n        },\r\n        {\r\n            deep: true,\r\n            immediate: true\r\n        }\r\n    )\r\n\r\n    //在map里增加相应的监听环节，如果变化就重新挂载\r\n    return {\r\n        getlayerref,\r\n        updatelayer,\r\n    }\r\n\r\n}\r\n\r\n\r\n)","import { defineStore } from \"pinia\"\r\nimport {ref} from 'vue'\r\nimport { useMapZoomStore } from \"./BallScalingStore\"\r\nimport { ComponentListStore } from \"./MapComponentStore\"\r\n\r\n\r\nexport const MapListStore=defineStore('mapViews',()=>{\r\n    const views = ref({\r\n        1:{\r\n            \"name\":'北京',\r\n            \"center\":[116.405415,39.907741],\r\n        },\r\n        2:{\r\n            \"name\":'上海',\r\n            \"center\":[121.47489,31.232838],\r\n        }\r\n    })\r\n    var IDcounter=3\r\n    const mapzoomstate=useMapZoomStore()\r\n    const componentliststore=ComponentListStore()\r\n    \r\n    //创建NewView必须走这里\r\n    function createNewView(orginstatus,name=\"\",center=[]){\r\n        const nowID=IDcounter\r\n        //如果未指定名称，名称就是新坐标球+nowID\r\n        if (name.length<=0){\r\n            name=\"新坐标球\"+nowID}\r\n        \r\n        views.value[nowID]={\r\n            \"name\":name,\r\n            \"center\":center\r\n        }\r\n        //创建对应的zoom状态\r\n        \r\n        console.log(\"新坐标球的zoom是\",orginstatus.zoom,\"center是\",orginstatus.center)\r\n        mapzoomstate.updateZoom(nowID,orginstatus.center,orginstatus.zoom)\r\n        //创建对应的style\r\n        componentliststore.createNewStyle(nowID)\r\n\r\n        IDcounter+=1\r\n        //会返回创建的新View的ID\r\n        return nowID\r\n    }\r\n    function deleteOldView(id) {\r\n    if (views.value[id]) {\r\n        delete views.value[id]\r\n        mapzoomstate.deleteZoom(id)\r\n        componentliststore.deleteStyle(id)\r\n    } else {\r\n        console.warn(`视图 ID ${id} 不存在，无法删除。`)\r\n    }\r\n    }\r\n    return {\r\n        views,\r\n        createNewView,\r\n        deleteOldView\r\n    }\r\n\r\n})\r\n","import { defineStore } from \"pinia\"\r\nimport {ref} from 'vue'\r\n\r\n\r\nexport const pickCenterStore = defineStore('mapCenterDetermine', () => {\r\n  const isPicking = ref(false)\r\n  const pickedCoord = ref(null)\r\n  const editball=ref(\"null\")\r\n  //开始拾取时\r\n  function startPicking(noweditball) {\r\n    console.log(\"Pickcenter组件开始拾取\")\r\n    isPicking.value = true\r\n    pickedCoord.value = null\r\n    //把正在编辑的ball设置成noweditball\r\n    editball.value=noweditball\r\n  }\r\n\r\n  function finishPicking(coord) {\r\n    console.log(\"Pickcenter组件结束拾取\")\r\n    pickedCoord.value = coord\r\n    isPicking.value = false\r\n    console.log(coord)\r\n  }\r\n\r\n  return {\r\n    isPicking,\r\n    pickedCoord,\r\n    editball,\r\n    startPicking,\r\n    finishPicking\r\n  }\r\n})","import { defineStore } from 'pinia'\r\nimport { reactive } from 'vue'\r\n\r\nexport const BallMovingScalingStore = defineStore('ballZoom', () => {\r\n  // 用 reactive 定义字典，两个key分别存状态\r\n  // 单纯管理两个ball的缩放状态\r\n  const zoomStates = reactive({\r\n    left: { zoom: null, center: null },\r\n    right: { zoom: null, center: null }\r\n  })\r\n    function setZoomState(id, zoom, center) {\r\n    //console.log(\"更新状态\")\r\n    if (!zoomStates[id]) {\r\n      // 防止传错id，简单创建一个空的\r\n      zoomStates[id] = { zoom: null, center: null }\r\n    }\r\n    zoomStates[id].zoom = zoom\r\n    zoomStates[id].center = center\r\n    //console.log(zoomStates)\r\n  }\r\n\r\n  return {\r\n    zoomStates,\r\n    setZoomState\r\n  }\r\n})","import { defineStore } from \"pinia\"\r\nimport {ref} from 'vue'\r\n\r\n\r\nexport const CoordDetermine = defineStore('mapcoorddetermine', () => {\r\n  const isPicking = ref(false)\r\n  const pickedCoord = ref(null)\r\n  const editball=ref(\"null\")\r\n  //储存着这次pick的类型\r\n  const coordtype=ref(\"null\")\r\n  //开始拾取时\r\n  function startPicking(noweditball,type) {\r\n    console.log(\"CoordDetermine组件开始拾取\")\r\n    isPicking.value = true\r\n    pickedCoord.value = null\r\n    //把正在编辑的ball设置成noweditball\r\n    editball.value=noweditball\r\n    coordtype.value=type\r\n  }\r\n\r\n  function finishPicking(coord) {\r\n    console.log(\"CoordDetermine组件结束拾取\")\r\n    pickedCoord.value = coord\r\n    isPicking.value = false\r\n    console.log(coord)\r\n  }\r\n\r\n  return {\r\n    isPicking,\r\n    pickedCoord,\r\n    editball,\r\n    coordtype,\r\n    startPicking,\r\n    finishPicking\r\n  }\r\n})","<template>\r\n  <div class=\"setting-pane\">\r\n    <!-- 显示情况 -->\r\n    <section class=\"section\">\r\n      <h3 class=\"titler\">显示情况</h3>\r\n      <div class=\"container\">\r\n        <div class=\"left ball-show \">\r\n          <div class=\"ball-show-floor1\">\r\n            <span>左球</span>\r\n            <select class=\"input-box\" ball=\"left\" v-model=\"ballstate.currentleftid\">\r\n              <option value=0 viewid=\"0\">空球</option>\r\n              <option v-for=\"(view, viewid) in mapviewstore.views\" :key=\"view.name\" :value=\"viewid\" :viewid=\"viewid\">{{\r\n                view.name }}</option>\r\n            </select>\r\n          </div>\r\n          <button class=\"btn small align\" ballid=\"left\" @click=\"scaletosame($event)\">比例到此</button>\r\n        </div>\r\n        <div class=\"right ball-show\">\r\n          <div class=\"ball-show-floor1\">\r\n            <span>右球</span>\r\n            <select class=\"input-box\" ball=\"right\" v-model=\"ballstate.currentrightid\">\r\n              <option value=0 viewid=\"0\">空球</option>\r\n              <option v-for=\"(view, viewid) in mapviewstore.views\" :key=\"view.name\" :value=\"viewid\" :viewid=\"viewid\">{{\r\n                view.name }}</option>\r\n            </select>\r\n          </div>\r\n          <button class=\"btn small align\" ballid=\"right\" @click=\"scaletosame($event)\">比例到此</button>\r\n        </div>\r\n\r\n      </div>\r\n\r\n    </section>\r\n\r\n    <!-- 编辑球体 -->\r\n    <section class=\"section\">\r\n      <h3 class=\"titler\">编辑</h3>\r\n      <div class=\"row\">\r\n        <select class=\"input-box\" id=\"editing-ball\" v-model=\"noweditball\">\r\n          <option disabled value=\"\" selected>请选择</option>\r\n          <option value=\"left\">左球</option>\r\n          <option value=\"right\">右球</option>\r\n        </select>\r\n        <button class=\"btn small ball-creation\" @click=\"createNewBall\">创建新球</button>\r\n        <button class=\"btn small ball-creation\" @click=\"deleteNowBall\">删除本球</button>\r\n      </div>\r\n      <div v-if=\"currenteditid > 0\">\r\n        <div class=\"row\">\r\n          <label>名称</label>\r\n          <input type=\"text\" class=\"custom-input\" v-model=\"currenteditview.name\">\r\n          <label>颜色</label>\r\n          <input type=\"color\" v-model=\"currenteditstyle.color\">\r\n        </div>\r\n        <div class=\"row\">\r\n          <span>中心</span>\r\n          <span v-if=\"currenteditview.center && currenteditview.center.length === 2\">\r\n            <span class=\"state\">已确定</span>\r\n            <button class=\"btn small\" @click=\"handlePanto\">缩放</button>\r\n          </span>\r\n          <span v-else-if=\"pickcenterstore.isPicking\">\r\n            <span class=\"state\">正在拾取</span>\r\n          </span>\r\n          <span v-else>\r\n            <span class=\"state\">无中心</span>\r\n            <button class=\"btn small\" @click=\"handlePickClick\">拾取</button>\r\n          </span>\r\n        </div>\r\n        <div class=\"row\">\r\n          \r\n          <label>创建图形</label>\r\n          <div v-if=\"currenteditview.center && currenteditview.center.length === 2\">\r\n            <div v-if=\"!coorddetermine.isPicking\" class=\"row\">\r\n              <input type=\"text\" class=\"custom-input\" v-model=\"tocreatename\">\r\n              <select class=\"input-box\" id=\"feature-creation\" v-model=\"tocreatetype\">\r\n                <option value=\"point\" selected>点</option>\r\n              </select>\r\n              <button @click=\"createmapcoorddetemineFeature\" class=\"btn small\">开始创建</button>\r\n            </div>\r\n          <div v-else class=\"row\">\r\n            <span class=\"state\">正在拾取</span>\r\n          </div>\r\n          </div>\r\n          <div v-else class=\"row\">\r\n            <span>请先指定中心</span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div v-else class=\"row\">\r\n        <span>未选择有效视图</span>\r\n      </div>\r\n      <!-- 创建新图形 -->\r\n\r\n\r\n      <!-- 图形表格 -->\r\n      <div class=\"table-wrapper\">\r\n        <table class=\"data-table\">\r\n          <thead>\r\n            <tr class=\"table-head\">\r\n              <th>名称</th>\r\n              <th>类型</th>\r\n              <th>操作</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            <tr v-for=\"(item, index) in paddedGeometry\" :key=\"index\">\r\n              <td>\r\n                <!--<input v-if=\"item.editable\" v-model=\"item.name\" />-->\r\n                <input v-if=\"item.editable\" :value=\"item.name\"\r\n                  @input=\"updateGeometryName(item._index, $event.target.value)\" />\r\n                <span v-else>{{ item.name || '' }}</span>\r\n              </td>\r\n              <td>{{ item.type || '' }}</td>\r\n              <td>\r\n                <button v-if=\"item.editable\" class=\"delete-btn\" @click=\"deleteItem(index)\">删除</button>\r\n              </td>\r\n            </tr>\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n      <!-- 标尺 -->\r\n      <div class=\"row\">\r\n        <label>标尺</label>\r\n        <input class=\"input-box\" />\r\n      </div>\r\n    </section>\r\n  </div>\r\n\r\n\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, watch, watchEffect, computed } from 'vue'\r\nimport { MapListStore } from '@/stores/MapListStroe'\r\nimport { ballstateStore } from '@/stores/ballstateStore'\r\nimport { pickCenterStore } from '@/stores/PickCenterStore'\r\nimport { BallMovingScalingStore } from '@/stores/BallMovingScalingStore'\r\nimport { useMapZoomStore } from '@/stores/BallScalingStore'\r\nimport { ComponentListStore } from '@/stores/MapComponentStore'\r\nimport { CoordDetermine } from '@/stores/CreateMapCoordDetemineFeatureStore'\r\n\r\nconst ballstate = ballstateStore()\r\nconst mapviewstore = MapListStore()\r\nconst pickcenterstore = pickCenterStore()\r\nconst ballmovingscalingstroe = BallMovingScalingStore()\r\nconst usemapzoomstroe = useMapZoomStore()\r\nconst componentliststore = ComponentListStore()\r\nconst coorddetermine = CoordDetermine()\r\n\r\n//检测球的变化\r\nwatch(() => ballstate.currentleftid, (newVal, oldVal) => {\r\n  console.log('ballstate.left从', oldVal, \"变成\", newVal)\r\n}, { deep: true })\r\nwatch(() => ballstate.currentrightid, (newVal, oldVal) => {\r\n  console.log('ballstate.right从', oldVal, \"变成\", newVal)\r\n}, { deep: true })\r\n\r\n//noweditball有三种格式,left,right和null\r\nconst noweditball = ref(\"null\")\r\n\r\nwatch(() => noweditball, (newVal) => {\r\n  console.log('noweditball 改变了', newVal.value)\r\n}, { deep: true })\r\n\r\n//现在editd的id要通过noweditball和ball自身的状态来获得\r\nconst currenteditid = ref(0)\r\n\r\n//反正就是不管是没在编辑还是主球是空,体现在纸面上就是currenteditid=0\r\nwatchEffect(() => {\r\n  if (noweditball.value == \"left\") {\r\n    currenteditid.value = ballstate.currentleftid\r\n  }\r\n  else if (noweditball.value == \"right\") {\r\n    currenteditid.value = ballstate.currentrightid\r\n  }\r\n  else {\r\n    currenteditid.value = 0\r\n  }\r\n  console.log(\"更新currentid到\" + currenteditid.value)\r\n})\r\n\r\nconst currenteditview = ref(\"null\")\r\n\r\nwatch(currenteditid, (newVal) => {\r\n  if (newVal == 0) {\r\n    //如果是0怎么处理d\r\n    currenteditview.value = {\r\n    }\r\n  }\r\n  else {\r\n    currenteditview.value = mapviewstore.views[newVal]\r\n  }\r\n})\r\n\r\n\r\n\r\nconst currenteditstyle = ref(\"null\")\r\nwatch(currenteditid, (newVal) => {\r\n  if (newVal == 0) {\r\n    //如果是0怎么处理\r\n    currenteditstyle.value = {\r\n    }\r\n  }\r\n  else {\r\n    currenteditstyle.value = componentliststore.style[newVal]\r\n  }\r\n})\r\n\r\n//创建新球的函数\r\n\r\n//在ball中实际上需要监听这里的currerntleft/rightfiled\r\n//如果是创建球，ball对应的id会变成新id\r\n//首先把当前的球的坐标传过去，然后球再建立从里边拉取坐标的关系\r\n//如果是删除球，ball对应的id会变成0\r\n\r\nfunction createNewBall() {\r\n  if (noweditball.value == \"left\") {\r\n    const orginstatus = ballmovingscalingstroe.zoomStates['left']\r\n    console.log(\"orginstatus是\", orginstatus)\r\n    const creatednewID = mapviewstore.createNewView(orginstatus);\r\n    console.log(\"新创建的ID是\", creatednewID)\r\n    //这里涉及到手动把currentid更改的问题\r\n    ballstate.currentleftid = creatednewID\r\n  }\r\n  else if (noweditball.value == \"right\") {\r\n    const orginstatus = ballmovingscalingstroe.zoomStates['right']\r\n    const creatednewID = mapviewstore.createNewView(orginstatus);\r\n    console.log(\"新创建的ID是\", creatednewID)\r\n    ballstate.currentrightid = creatednewID\r\n  }\r\n}\r\n\r\nfunction deleteNowBall() {\r\n  if (noweditball.value == \"left\") {\r\n    const todelid = ballstate.currentleftid\r\n    ballstate.currentleftid = 0\r\n    mapviewstore.deleteOldView(todelid)\r\n    console.log(\"删除的ID是\", todelid)\r\n  }\r\n  else if (noweditball.value == \"right\") {\r\n    const todelid = ballstate.currentrightid\r\n    ballstate.currentrightid = 0\r\n    mapviewstore.deleteOldView(todelid)\r\n    console.log(\"删除的ID是\", todelid)\r\n\r\n  }\r\n\r\n\r\n}\r\n\r\nfunction handlePickClick() {\r\n  //noeditball有left right和null三种类型，每个球收到之后看看符不符合自己吧\r\n  pickcenterstore.startPicking(noweditball.value)\r\n}\r\n\r\n//结束拾取的话，就把这个坐标加上\r\nwatch(\r\n  () => pickcenterstore.isPicking, // \r\n  (newVal, oldVal) => {\r\n    if (!newVal && oldVal) {\r\n      currenteditview.value.center = pickcenterstore.pickedCoord\r\n      console.log(\"控制区已设定中心坐标\")\r\n      console.log(\"现在的mapview是\", mapviewstore)\r\n    }\r\n  }\r\n)\r\n\r\nfunction handlePanto() {\r\n  const getcenter = mapviewstore.views[currenteditid.value].center;\r\n  usemapzoomstroe.updateZoom(currenteditid.value, getcenter, usemapzoomstroe.zoomState[currenteditid.value].scale)\r\n}\r\n\r\nfunction scaletosame(event) {\r\n  const buttonEl = event.currentTarget\r\n  const ballid = buttonEl.getAttribute(\"ballid\")\r\n  //nowmapid是这个ball现在对应的id\r\n  const nowmapid = ballstate.getcurrentid(ballid)\r\n  //我们要拿着这个id去找对应的scale\r\n  //如果这是个有效的id\r\n  if (usemapzoomstroe.getZoomState(nowmapid)) {\r\n    const getscale = usemapzoomstroe.getZoomState(nowmapid).scale\r\n    if (usemapzoomstroe.getZoomState(ballstate.currentleftid)) {\r\n      usemapzoomstroe.updateZoom(ballstate.currentleftid, usemapzoomstroe.zoomState[ballstate.currentleftid].zoomcenter, getscale)\r\n    }\r\n    if (usemapzoomstroe.getZoomState(ballstate.currentrightid)) {\r\n      usemapzoomstroe.updateZoom(ballstate.currentrightid, usemapzoomstroe.zoomState[ballstate.currentrightid].zoomcenter, getscale)\r\n    }\r\n\r\n  }\r\n}\r\n//import { storeToRefs } from 'pinia'\r\n\r\n//const { style } = storeToRefs(componentliststore)\r\n\r\nconst geometry = computed(() => {\r\n  return componentliststore.getStyle(currenteditid.value)?.geometry || []\r\n})\r\n\r\n/*\r\nconst paddedGeometry = computed(() => {\r\n  // 把 geometry 中的每个对象复制一份，并加上 editable: true\r\n  const real = geometry.value.map(g => ({ ...g, editable: true }))\r\n  // 不足 5 行时补充空白行，editable: false 表示空行不可编辑\r\n  const pad = Array.from({ length: Math.max(0, 5 - real.length) }, () => ({\r\n    name: '',\r\n    type: '',\r\n    editable: false\r\n  }))\r\n  return [...real, ...pad]\r\n})\r\n*/\r\nconst paddedGeometry = computed(() => {\r\n  const real = geometry.value.map((g, i) => ({\r\n    ...g,\r\n    editable: true,\r\n    _index: i\r\n  }))\r\n  const pad = Array.from({ length: Math.max(0, 5 - real.length) }, () => ({\r\n    name: '',\r\n    type: '',\r\n    editable: false\r\n  }))\r\n  return [...real, ...pad]\r\n})\r\nfunction updateGeometryName(index, val) {\r\n  const style = componentliststore.getStyle(currenteditid.value)\r\n  if (style && style.geometry[index]) {\r\n    style.geometry[index].name = val\r\n  }\r\n}\r\n\r\nfunction deleteItem(index) {\r\n  const style = componentliststore.getStyle(currenteditid.value)\r\n  if (!style) return\r\n  const list = style.geometry\r\n  if (list && index >= 0 && index < list.length) {\r\n    list.splice(index, 1)\r\n  }\r\n}\r\n\r\nconst tocreatetype = ref(\"point\")\r\nconst tocreatename = ref(\"新地\")\r\nfunction createmapcoorddetemineFeature() {\r\n  coorddetermine.startPicking(noweditball.value, tocreatetype.value)\r\n}\r\n\r\n//拾取结束后\r\nwatch(\r\n  () => coorddetermine.isPicking, // \r\n  (newVal, oldVal) => {\r\n    if (!newVal && oldVal) {\r\n      const geom = {\r\n        \"name\": tocreatename.value,\r\n        \"type\": tocreatetype.value,\r\n        \"dist\": coorddetermine.pickedCoord[\"distance\"],\r\n        \"direction\": coorddetermine.pickedCoord[\"bearing\"]\r\n      }\r\n      componentliststore.addGeometryToStyle(currenteditid.value, geom)\r\n      tocreatename.value = \"新地\"\r\n      //console.log(\"把\", coorddetermine.pickedCoord, \"上传给\", currenteditid.value)\r\n    }\r\n  }\r\n)\r\n\r\n//下面的代码对Style进行监听\r\n\r\n//性能问题先摆到一边\r\n//先修改列表，后矫正视图\r\n//这种应该取消一次重绘，就是说如果是创建或者删除的\r\n//我们先不管他\r\n/*\r\nwatch(\r\n  () => componentliststore.style,\r\n  (newVal, oldVal) => {\r\n    const added = []\r\n    const deleted = []\r\n    const updated = []\r\n\r\n    const newKeys = Object.keys(newVal || {})\r\n    const oldKeys = Object.keys(oldVal || {})\r\n\r\n    console.log(\"newKeys\",newKeys,\"oldKeys\",oldKeys)\r\n    console.log(newVal,oldVal)\r\n    // 新增的 key\r\n    newKeys.forEach(key => {\r\n      if (!oldKeys.includes(key)) {\r\n        added.push(key)\r\n      }\r\n    })\r\n\r\n    // 删除的 key\r\n    oldKeys.forEach(key => {\r\n      if (!newKeys.includes(key)) {\r\n        deleted.push(key)\r\n      }\r\n    })\r\n\r\n    // 修改的 key\r\n    newKeys.forEach(key => {\r\n      if (oldKeys.includes(key)) {\r\n        if (JSON.stringify(newVal[key]) !== JSON.stringify(oldVal[key])) {\r\n          updated.push(key)\r\n        }\r\n      }\r\n    })\r\n\r\n    console.log('新增 keys:', added)\r\n    console.log('删除 keys:', deleted)\r\n    console.log('修改 keys:', updated)\r\n  },\r\n  {\r\n    immediate: true,\r\n    deep: true\r\n  }\r\n)\r\n*/\r\n\r\n\r\n</script>\r\n\r\n<style scoped>\r\n.titler {\r\n  margin: 10px;\r\n}\r\n\r\n.setting-pane {\r\n  padding: 10px;\r\n  background-color: #f9f9f9;\r\n  font-family: '宋体', serif;\r\n  border: 1px solid #000;\r\n}\r\n\r\n.section {\r\n  border-bottom: 1px solid #000;\r\n  margin-bottom: 10px;\r\n  padding-bottom: 10px;\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.container {\r\n  display: flex;\r\n  /* 两个 leftball 横向排列 */\r\n  justify-content: space-between;\r\n  /* 左右分开 */\r\n  gap: 1px;\r\n  /* 两个盒子间距 */\r\n}\r\n\r\n\r\n.ball-show {\r\n  display: flex;\r\n  flex-direction: column;\r\n  border: 1px solid #ccc;\r\n  padding: 10px;\r\n  width: 45%;\r\n  /* 两个盒子各占宽度 */\r\n  box-sizing: border-box;\r\n  justify-content: center;\r\n  align-items: center;\r\n}\r\n\r\n.ball-show-floor1 {\r\n  align-items: center;\r\n  display: flex;\r\n  margin-bottom: 8px;\r\n\r\n}\r\n\r\n.input-box {\r\n  width: 20px;\r\n  /* select 占满剩余空间 */\r\n  margin-left: 8px;\r\n}\r\n\r\n.align {\r\n  width: 80%;\r\n\r\n}\r\n\r\n.btn {\r\n  padding: 6px;\r\n  cursor: pointer;\r\n}\r\n\r\n.row {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8px;\r\n  margin: 8px 0;\r\n  flex-wrap: wrap;\r\n}\r\n\r\n.input-box {\r\n  width: 60px;\r\n  height: 24px;\r\n  background-color: #4a90e2;\r\n  border: none;\r\n  color: white;\r\n}\r\n\r\n.btn {\r\n  background-color: #4a90e2;\r\n  color: white;\r\n  border: none;\r\n  padding: 6px 10px;\r\n  cursor: pointer;\r\n  font-size: 14px;\r\n}\r\n\r\n.btn.small {\r\n  padding: 4px 6px;\r\n  font-size: 12px;\r\n}\r\n\r\n.custom-input {\r\n  border: none;\r\n  border-bottom: 1px solid #aaa;\r\n  background: transparent;\r\n  padding: 4px 0;\r\n  font-size: 14px;\r\n  width: 100px;\r\n  color: #333;\r\n  outline: none;\r\n  transition: border-color 0.3s;\r\n}\r\n\r\n.custom-input:focus {\r\n  border-bottom: 1px solid #4a90e2;\r\n  /* 聚焦变色 */\r\n}\r\n\r\n\r\n.state {\r\n  font-family: \"黑体\", \"SimHei\", \"Microsoft YaHei\";\r\n  font-size: 14px;\r\n  display: inline-flex;\r\n  /* 或 flex，如果是 block 元素 */\r\n  align-items: center;\r\n  /* 垂直居中 */\r\n  padding: 0 10px;\r\n}\r\n\r\n/*表格样式*/\r\n.table-wrapper {\r\n  max-height: 300px;\r\n  /* 根据需要调整最大高度 */\r\n  overflow-y: auto;\r\n  border: 1px solid #ccc;\r\n  border-radius: 4px;\r\n}\r\n\r\n/* 保持表格宽度自适应容器 */\r\n.data-table {\r\n  width: 100%;\r\n  border-collapse: separate;\r\n  border-spacing: 0;\r\n  table-layout: fixed;\r\n  font-family: \"微软雅黑\", Arial, sans-serif;\r\n  color: #333;\r\n}\r\n\r\n/* 表头样式 */\r\n.data-table thead tr.table-head {\r\n  background-color: #4a90e2;\r\n  /* 统一主色 */\r\n  color: white;\r\n  font-weight: bold;\r\n  user-select: none;\r\n  position: sticky;\r\n  top: 0;\r\n  z-index: 10;\r\n}\r\n\r\n.data-table thead tr.table-head th {\r\n  text-align: center;\r\n  padding: 12px 8px;\r\n  /* 稍微加大点内边距 */\r\n  border-bottom: 2px solid #3a78c2;\r\n  /* 深一点的分割线 */\r\n  background-clip: padding-box;\r\n  /* 防止边框透出 */\r\n}\r\n\r\n/* 单元格样式 */\r\n.data-table th,\r\n.data-table td {\r\n  border: none;\r\n  height: 42px;\r\n  /* 微调高度 */\r\n  padding: 8px 12px;\r\n  /* 左右间距统一 */\r\n  text-align: center;\r\n  vertical-align: middle;\r\n  box-sizing: border-box;\r\n  overflow: hidden;\r\n  white-space: nowrap;\r\n  text-overflow: ellipsis;\r\n  transition: background-color 0.3s;\r\n}\r\n\r\n.data-table tbody tr:nth-child(odd) {\r\n  background-color: #f9f9f9;\r\n}\r\n\r\n.data-table tbody tr:nth-child(even) {\r\n  background-color: #ffffff;\r\n}\r\n\r\n/* 调整列宽 */\r\n.data-table th:nth-child(1),\r\n.data-table td:nth-child(1) {\r\n  width: 35%;\r\n  text-align: left;\r\n  /* 名称左对齐 */\r\n  padding-left: 16px;\r\n}\r\n\r\n.data-table th:nth-child(2),\r\n.data-table td:nth-child(2) {\r\n  width: 45%;\r\n}\r\n\r\n.data-table th:nth-child(3),\r\n.data-table td:nth-child(3) {\r\n  width: 120px;\r\n  /* 固定宽度，确保删除按钮不被遮挡 */\r\n  text-align: center;\r\n  padding-right: 12px;\r\n  white-space: nowrap;\r\n}\r\n\r\n/* 输入框样式 - 统一和其他输入框风格 */\r\n.data-table input {\r\n  width: 100%;\r\n  box-sizing: border-box;\r\n  border: none;\r\n  border-bottom: 2px solid #4a90e2;\r\n  padding: 6px 4px;\r\n  font-size: 14px;\r\n  color: #333;\r\n  background: transparent;\r\n  transition: border-color 0.3s, background-color 0.3s;\r\n  outline: none;\r\n}\r\n\r\n.data-table input:focus {\r\n  border-bottom-color: #2c6cdf;\r\n  background-color: #eaf4ff;\r\n  /* 聚焦时浅蓝底 */\r\n}\r\n\r\n/* 删除按钮样式 */\r\n.delete-btn {\r\n  cursor: pointer;\r\n  line-height: 1;\r\n  display: inline-block;\r\n  padding: 6px 14px;\r\n  /* 和按钮padding对应 */\r\n  font-size: 14px;\r\n  background-color: #999;\r\n  /* 红色警告 */\r\n  color: white;\r\n  border: none;\r\n  border-radius: 3px;\r\n  user-select: none;\r\n  transition: background-color 0.2s;\r\n  white-space: nowrap;\r\n}\r\n\r\n.delete-btn:hover {\r\n  background-color: #c0392b;\r\n}\r\n</style>","import script from \"./SettingPane.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./SettingPane.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./SettingPane.vue?vue&type=style&index=0&id=30773890&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-30773890\"]])\n\nexport default __exports__","<template>\r\n  <div ref=\"mapContainer\" class=\"map\"></div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted,watch,computed } from 'vue'\r\nimport L from 'leaflet'\r\nimport 'leaflet/dist/leaflet.css'\r\nimport { pickCenterStore } from '@/stores/PickCenterStore'\r\nimport { BallMovingScalingStore } from '@/stores/BallMovingScalingStore'\r\nimport { ballstateStore } from '@/stores/ballstateStore'\r\nimport { useMapZoomStore } from '@/stores/BallScalingStore'\r\nimport { CoordDetermine } from '@/stores/CreateMapCoordDetemineFeatureStore'\r\nimport { computeDistanceAndBearing } from '@/tools/coord_polar'\r\nimport { MapListStore } from '@/stores/MapListStroe'\r\nimport { DrawBallMap } from '@/stores/MapComponentStore'\r\n\r\ndelete L.Icon.Default.prototype._getIconUrl\r\nL.Icon.Default.mergeOptions({\r\n  iconUrl: '/images/marker-icon.png',\r\n  iconRetinaUrl: '/images/marker-icon-2x.png',\r\n  shadowUrl: '/images/marker-shadow.png',\r\n})\r\n\r\n\r\nconst usemapzoomstroe=useMapZoomStore()\r\nconst mapliststore=MapListStore()\r\nconst drawballmap=DrawBallMap()\r\n\r\nconst props = defineProps({\r\n  id: String\r\n})\r\n\r\nconsole.log(\"初始化球\",props.id,\"成功\")\r\nconst mapContainer = ref(null)\r\nlet mapInstance = null\r\n\r\nfunction initMap(){\r\n    if (mapInstance) {\r\n    mapInstance.remove()  // 销毁旧地图，防止重复初始化\r\n    }\r\n    mapInstance = L.map(mapContainer.value,{\r\n  zoomAnimation: false,\r\n}).setView([39.9042, 116.4074], 13,{ animate: false })\r\n    L.tileLayer('https://webrd04.is.autonavi.com/appmaptile?lang=zh_cn&size=1&scale=1&style=7&x={x}&y={y}&z={z}', {\r\n        maxZoom: 18,\r\n        attribution: '© 高德地图'\r\n    }).addTo(mapInstance)\r\n}\r\n\r\nconst pickcenter=pickCenterStore()\r\n\r\nfunction setupPickingWatcher() {\r\n  // 1. 在外层定义 clickHandler，保证引用一致\r\n  const clickHandler = (e) => {\r\n    const coord = [e.latlng.lng, e.latlng.lat]\r\n    pickcenter.finishPicking(coord)\r\n  }\r\n  watch(\r\n    () => pickcenter.isPicking,\r\n    (newVal) => {\r\n      if ((newVal) && (pickcenter.editball==props.id)) {\r\n        console.log(\"地图\",props.id,\"响应拾取\")\r\n        mapInstance.on('click', clickHandler)\r\n      } else {\r\n        console.log(\"地图禁止拾取\")\r\n        mapInstance.off('click', clickHandler)\r\n      }\r\n    }\r\n  )\r\n}\r\n\r\n\r\n\r\nconst coorddetermine=CoordDetermine()\r\n\r\nfunction setupCoordWatcher() {\r\n  const tempPolygonPoints = [] // 暂存 polygon 点坐标\r\n\r\n  // Point 拾取：点击地图时触发\r\n  //转换成geolib的格式\r\n  const pointClickHandler = (e) => {\r\n    const coord ={\r\n        latitude: e.latlng.lat,\r\n        longitude: e.latlng.lng\r\n      }\r\n      const centerpoint={\r\n        latitude:mapliststore.views[currentBallId.value].center[1],\r\n        longitude:mapliststore.views[currentBallId.value].center[0]\r\n      }\r\n      \r\n      const newcoord=computeDistanceAndBearing(centerpoint,coord,\"single\")\r\n      console.log(\"拾取的点距离是\",newcoord.distance,\"方位角是\",newcoord.bearing)\r\n      \r\n    coorddetermine.finishPicking(newcoord)\r\n  }\r\n\r\n  // Polygon 拾取：点击地图添加点\r\n  const polygonClickHandler = (e) => {\r\n    const coord ={\r\n        latitude: e.latlng.lat,\r\n        longitude: e.latlng.lng\r\n      }\r\n    const centerpoint={\r\n      latitude:mapliststore.views[currentBallId.value].center[1],\r\n      longitude:mapliststore.views[currentBallId.value].center[0]\r\n    }\r\n    const newcoord=computeDistanceAndBearing(centerpoint,coord,\"single\")\r\n    console.log(\"拾取的点距离是\",newcoord.distance,\"方位角是\",newcoord.bearing)\r\n    tempPolygonPoints.push(newcoord)\r\n    // 可选：可在此处临时绘制点或连线以做反馈\r\n  }\r\n  // Polygon 完成：右键结束拾取\r\n  const polygonFinishHandler = () => {\r\n    if (tempPolygonPoints.length >= 3) {\r\n\r\n      //对tempPolygonPoints处理\r\n      coorddetermine.finishPicking([...tempPolygonPoints])\r\n    } else {\r\n      console.warn(\"多边形至少需要三个点\")\r\n    }\r\n    tempPolygonPoints.length = 0 // 清空\r\n  }\r\n\r\n  // 监听拾取状态变化\r\n  watch(\r\n    () => coorddetermine.isPicking,\r\n    (newVal) => {\r\n      const isActive = newVal && coorddetermine.editball === props.id\r\n      if (isActive) {\r\n        console.log(\"地图\", props.id, \"响应拾取\")\r\n        console.log(coorddetermine.coordtype)\r\n        if (coorddetermine.coordtype === \"point\") {\r\n          console.log(\"拾取点\")\r\n          mapInstance.on(\"click\", pointClickHandler)\r\n        } else if (coorddetermine.coordtype === \"polygon\") {\r\n          console.log(\"拾取面\")\r\n          mapInstance.on(\"click\", polygonClickHandler)\r\n          mapInstance.on(\"contextmenu\", polygonFinishHandler)\r\n        }\r\n      } else {\r\n        console.log(\"不拾取\")\r\n        console.log(\"地图\", props.id, \"停止拾取\")\r\n        mapInstance.off(\"click\", pointClickHandler)\r\n        mapInstance.off(\"click\", polygonClickHandler)\r\n        mapInstance.off(\"contextmenu\", polygonFinishHandler)\r\n        tempPolygonPoints.length = 0\r\n      }\r\n    },\r\n    \r\n  )\r\n}\r\n\r\n\r\n\r\nconst ballmovingscalingstore=BallMovingScalingStore()\r\n\r\nfunction updateballscaling(){\r\n    //console.log(\"地图\",props.id,\"上传状态,zoom\",mapInstance.getZoom(),\"中心\",[mapInstance.getCenter().lng,mapInstance.getCenter().lat])\r\n    ballmovingscalingstore.setZoomState(props.id,mapInstance.getZoom(),[mapInstance.getCenter().lng,mapInstance.getCenter().lat]) \r\n}\r\n\r\n//绑定的函数\r\nfunction setupupdateballscaling(){\r\n    updateballscaling()\r\n    mapInstance.on('moveend', updateballscaling)\r\n}\r\n\r\n//从ballstateStore中监控自己对应的球变没变\r\nconst ballstatestore=ballstateStore()\r\n\r\nconst currentBallId = computed(() => ballstatestore.getcurrentid(props.id))\r\nconsole.log(\"初始化的地图id是\",currentBallId.value)\r\n\r\nlet isProgrammaticMove = false\r\n\r\n//监测BallID发生变化\r\n//BallID变化是非常严重的问题，意味着我们的tag也要重画\r\nwatch(currentBallId, (newId) => {\r\n    const state = usemapzoomstroe.getZoomState(newId)\r\n    if (state && state.scale && state.zoomcenter) {\r\n      mapInstance.setView([state.zoomcenter[1],state.zoomcenter[0]], state.scale,{ animate: false })\r\n  }\r\n})\r\n\r\n//检测本身的变化\r\nwatch(() => usemapzoomstroe.zoomState[currentBallId.value],\r\n  (val) => {\r\n    if (!val) return;\r\n    if (isProgrammaticMove) {\r\n      // 已由程序触发，不再处理\r\n      isProgrammaticMove = false;\r\n      return;\r\n    }\r\n\r\n    isProgrammaticMove = true; // 标记这次是程序性移动，防止 moveend 再次更新状态\r\n    mapInstance.setView(L.latLng(val.zoomcenter[1], val.zoomcenter[0]), val.scale,{ animate: false });\r\n  },\r\n  { deep: true }\r\n)\r\n//这个是根据地图的移动更新对应的Instance的状态\r\nfunction renowalmapstate(){\r\n    if (usemapzoomstroe.getZoomState(currentBallId.value)){\r\n        if (!isProgrammaticMove) {\r\n            //console.log(\"用户拖动地图，更新状态\", currentBallId.value)\r\n            usemapzoomstroe.updateZoom(\r\n              currentBallId.value,\r\n              [mapInstance.getCenter().lng, mapInstance.getCenter().lat],\r\n              mapInstance.getZoom()\r\n            )\r\n        }\r\n        isProgrammaticMove = false; // 重置标记\r\n    }\r\n}\r\n\r\nfunction setuprenowalmapstate(){\r\n    renowalmapstate()\r\n    mapInstance.on('moveend', renowalmapstate)\r\n}\r\n\r\n\r\nconst mountedLayers = ref([])\r\n\r\nlet isZooming = false\r\nlet pendingLayerUpdate = false\r\n\r\n\r\n\r\nfunction setupZoomLayerProtection() {\r\n  mapInstance.on('zoomstart', () => {\r\n    isZooming = true\r\n  })\r\n\r\n  mapInstance.on('zoomend', () => {\r\n  isZooming = false\r\n  if (pendingLayerUpdate) {\r\n    requestAnimationFrame(() => {\r\n      doUpdateLayersSafe()\r\n      pendingLayerUpdate = false\r\n    })\r\n  }\r\n})\r\n}\r\n\r\nfunction doUpdateLayersSafe() {\r\n  //console.log(\"更新图层 safely\")\r\n  // 1. 清除旧图层\r\n  mountedLayers.value.forEach(layer => {\r\n    if (mapInstance._animatingZoom) {\r\n      //console.warn('正在动画中，延迟移除');\r\n    } else {\r\n      layer.off()\r\n      //如果我在现在就直接_map=null，那么我切换地图就会报错\r\n      //updatelayer是由于我的地图中心点发生了变化，地图中心点变化是因为我切换了currentBallId\r\n      //currentballID带来重算\r\n      //layer._map = null; // 断开与地图的连接（非公开 API，慎用）\r\n      layer._renderer = null;\r\n      mapInstance.removeLayer(layer);\r\n      //console.log('成功移除')\r\n    }\r\n  })\r\n  mountedLayers.value = []\r\n\r\n  // 2. 添加新图层\r\n  const newLayers = drawballmap.getlayerref(props.id).value\r\n  if (Array.isArray(newLayers)) {\r\n    newLayers.forEach(layer => {\r\n      if (layer && typeof layer.addTo === 'function') {\r\n        layer.addTo(mapInstance)\r\n        mountedLayers.value.push(layer)\r\n      }\r\n    })\r\n  }\r\n  console.log(\"现在挂载的有\",mountedLayers)\r\n}\r\n\r\n// 修改后的 watcher\r\nwatch(\r\n  () => drawballmap.getlayerref(props.id),\r\n  () => {\r\n    if (!mapInstance) return\r\n    if (isZooming) {\r\n      pendingLayerUpdate = true\r\n    } else {\r\n      doUpdateLayersSafe()\r\n    }\r\n  },\r\n  {\r\n    deep: true,\r\n    immediate: true\r\n  }\r\n)\r\n\r\nonMounted(() => {\r\n    initMap()\r\n    setupPickingWatcher()\r\n    setupCoordWatcher()\r\n    setupupdateballscaling()\r\n    setuprenowalmapstate()\r\n    setupZoomLayerProtection()\r\n    console.log(\"初始化的新地图\",mapInstance)\r\n})\r\n\r\n\r\n\r\n</script>\r\n\r\n<style scoped>\r\n.map {\r\n  height: 100%;\r\n  width: 100%;\r\n}\r\n</style>","import script from \"./EarthPane.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./EarthPane.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./EarthPane.vue?vue&type=style&index=0&id=516c7528&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-516c7528\"]])\n\nexport default __exports__","import { render } from \"./GeneralFrame.vue?vue&type=template&id=61a180d0\"\nimport script from \"./GeneralFrame.vue?vue&type=script&lang=js\"\nexport * from \"./GeneralFrame.vue?vue&type=script&lang=js\"\n\nimport \"./GeneralFrame.vue?vue&type=style&index=0&id=61a180d0&lang=css\"\n\nimport exportComponent from \"../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { createApp } from 'vue'\nimport { createPinia } from 'pinia';\nimport GeneralFrame from './GeneralFrame.vue'\nconst app=createApp(GeneralFrame);\nconst pinia = createPinia();\n//\n\napp.use(pinia);\napp.mount('#app')\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","var deferred = [];\n__webpack_require__.O = function(result, chunkIds, fn, priority) {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\n\t\tvar fn = deferred[i][1];\n\t\tvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every(function(key) { return __webpack_require__.O[key](chunkIds[j]); })) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t792: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = function(chunkId) { return installedChunks[chunkId] === 0; };\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = function(parentChunkLoadingFunction, data) {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some(function(id) { return installedChunks[id] !== 0; })) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkcitycompare\"] = self[\"webpackChunkcitycompare\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [504], function() { return __webpack_require__(5365); })\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["class","_createElementBlock","_hoisted_1","_createVNode","_component_headPane","_createElementVNode","_hoisted_2","_hoisted_3","_hoisted_4","_component_EarthPane","id","_component_footPane","_component_SettingPane","_cache","name","__exports__","_createTextVNode","href","useMapZoomStore","defineStore","zoomState","reactive","zoomcenter","scale","updateZoom","console","log","deleteZoom","getZoomState","ballstateStore","currentleftid","ref","currentrightid","getcurrentid","value","computeDistanceAndBearing","centerPoint","coord","mode","distance","getDistance","bearing","getGreatCircleBearing","computeSymmetricPoint","computeDestinationPoint","ComponentListStore","style","createNewStyle","color","warn","show","geometry","deleteStyle","getStyle","result","addGeometryToStyle","geometryItem","push","getAllStyleKeys","Object","keys","createLabeledMarker","lat","lng","label","icon","L","className","html","iconSize","iconAnchor","Default","prototype","_getIconUrl","mergeOptions","iconUrl","iconRetinaUrl","shadowUrl","DrawBallMap","ballstate","mapliststore","MapListStore","componentliststore","leftBallCenter","computed","views","center","rightBallCenter","drawedlayerleft","shallowRef","drawedlayerright","getlayerref","side","updatelayer","geomlist","Array","isArray","length","marker","idlist","latitude","longitude","styleObj","markerList","geo","type","dist","direction","point","layerGroup","watch","deep","immediate","IDcounter","mapzoomstate","createNewView","orginstatus","nowID","zoom","deleteOldView","pickCenterStore","isPicking","pickedCoord","editball","startPicking","noweditball","finishPicking","BallMovingScalingStore","zoomStates","left","right","setZoomState","CoordDetermine","coordtype","mapviewstore","pickcenterstore","ballmovingscalingstroe","usemapzoomstroe","coorddetermine","newVal","oldVal","currenteditid","watchEffect","currenteditview","currenteditstyle","createNewBall","creatednewID","deleteNowBall","todelid","handlePickClick","handlePanto","getcenter","scaletosame","event","buttonEl","currentTarget","ballid","getAttribute","nowmapid","getscale","paddedGeometry","real","map","g","i","editable","_index","pad","from","Math","max","updateGeometryName","index","val","deleteItem","list","splice","tocreatetype","tocreatename","createmapcoorddetemineFeature","geom","drawballmap","props","__props","mapContainer","mapInstance","initMap","remove","zoomAnimation","setView","animate","maxZoom","attribution","addTo","pickcenter","setupPickingWatcher","clickHandler","e","latlng","on","off","setupCoordWatcher","tempPolygonPoints","pointClickHandler","centerpoint","currentBallId","newcoord","polygonClickHandler","polygonFinishHandler","isActive","ballmovingscalingstore","updateballscaling","getZoom","getCenter","setupupdateballscaling","ballstatestore","isProgrammaticMove","renowalmapstate","setuprenowalmapstate","newId","state","mountedLayers","isZooming","pendingLayerUpdate","setupZoomLayerProtection","requestAnimationFrame","doUpdateLayersSafe","forEach","layer","_animatingZoom","_renderer","removeLayer","newLayers","onMounted","components","headPane","footPane","SettingPane","EarthPane","render","app","createApp","GeneralFrame","pinia","createPinia","use","mount","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","call","m","deferred","O","chunkIds","fn","priority","notFulfilled","Infinity","fulfilled","j","every","key","r","n","getter","__esModule","d","a","definition","o","defineProperty","enumerable","get","globalThis","this","Function","window","obj","prop","hasOwnProperty","installedChunks","chunkId","webpackJsonpCallback","parentChunkLoadingFunction","data","moreModules","runtime","some","chunkLoadingGlobal","self","bind","__webpack_exports__"],"sourceRoot":""}